const chai = require('chai');
const Security = require('../index');
const SHA256 = require('crypto-js/sha256');

const expect = chai.expect;

describe('Testing by Array Payload', () => {
  const payload = [{
    keyword: 'qwertyuiopasdfghjklzxcvbnm',
  }];
  let encryptedText = '';

  it('ENCRYPT: it should return encrypted data', (done) => {
    encryptedText = Security.encrypt(payload, SHA256('Message').toString());
    expect(encryptedText).to.be.a('string');
    done();
  });

  it('DECRYPT: it should return decrypted data', (done) => {
    const data = Security.decrypt(encryptedText);
    expect(data).to.be.a('array');
    expect(data).to.deep.equal(payload);
    done();
  });
});

describe('Testing by Object Payload', () => {
  const payload = {
    keyword: 'qwertyuiopasdfghjklzxcvbnm',
  };
  let encryptedText = '';

  it('ENCRYPT: it should return encrypted data', (done) => {
    encryptedText = Security.encrypt(payload, SHA256('Message').toString());
    expect(encryptedText).to.be.a('string');
    done();
  });

  it('DECRYPT: it should return decrypted data', (done) => {
    const data = Security.decrypt(encryptedText);
    expect(data).to.be.a('object');
    expect(data).to.deep.equal(payload);
    done();
  });
});
